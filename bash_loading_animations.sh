#!/usr/bin/env bash

# Source: https://github.com/Silejonu/bash_loading_animations

# shellcheck disable=SC2034 # https://github.com/koalaman/shellcheck/wiki/SC2034

### Loading animations list ###
# The first value of an array is the interval (in seconds) between each frame

## ASCII animations ##
# Will work in any terminal, including the TTY.
BLA_classic=( 0.25 '-' "\\" '|' '/' )
BLA_box=( 0.2 â”¤ â”´ â”œ â”¬ )
BLA_bubble=( 0.6 Â· o O O o Â· )
BLA_breathe=( 0.9 'Â Â ()Â Â ' 'Â (Â Â )Â ' '(Â Â Â Â )' 'Â (Â Â )Â ' )
BLA_growing_dots=( 0.5 '.Â Â ' '..Â ' '...' '..Â ' '.Â Â ' 'Â Â Â ' )
BLA_passing_dots=( 0.25 '.Â Â ' '..Â ' '...' 'Â ..' 'Â Â .' 'Â Â Â ' )
BLA_metro=( 0.2 '[Â Â Â Â ]' '[=Â Â Â ]' '[==Â Â ]' '[===Â ]' '[Â ===]' '[Â Â ==]' '[Â Â Â =]' )
BLA_snake=( 0.4 '[=Â Â Â Â Â ]' '[~<Â Â Â Â ]' '[~~=Â Â Â ]' '[~~~<Â Â ]' '[Â ~~~=Â ]' '[Â Â ~~~<]' '[Â Â Â ~~~]' '[Â Â Â Â ~~]' '[Â Â Â Â Â ~]' '[Â Â Â Â Â Â ]' )
BLA_filling_bar=( 0.25 'â–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’' 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ')

## UTF-8 animations ##
# Require Unicode support (will work in most modern terminals, but not in TTY).
# Some animations may not render properly with certain fonts.
BLA_classic_utf8=( 0.25 'â€”' "\\" '|' '/' )
BLA_bounce=( 0.3 . Â· Ë™ Â· )
BLA_vertical_block=( 0.25 â– â–‚ â–ƒ â–„ â–… â–† â–‡ â–ˆ â–ˆ â–‡ â–† â–… â–„ â–ƒ â–‚ â– )
BLA_horizontal_block=( 0.25 â– â–Ž â– â–Œ â–‹ â–Š â–‰ â–‰ â–Š â–‹ â–Œ â– â–Ž â– )
BLA_quarter=( 0.25 â–– â–˜ â– â–— )
BLA_triangle=( 0.45 â—¢ â—£ â—¤ â—¥)
BLA_semi_circle=( 0.1 â— â—“ â—‘ â—’ )
BLA_rotating_eyes=( 0.4 â—¡â—¡ âŠ™âŠ™ âŠ™âŠ™ â— â—  )
BLA_firework=( 0.4 'â¢€' 'â  ' 'â ' 'â ˆ' '*' '*' 'Â ' )
BLA_braille=( 0.2 â  â ‚ â „ â¡€ â¢€ â   â  â ˆ )
BLA_braille_whitespace=( 0.2 â£¾ â£½ â£» â¢¿ â¡¿ â£Ÿ â£¯ â£· )
BLA_trigram=( 0.25 â˜° â˜± â˜³ â˜¶ â˜´ )
BLA_arrow=( 0.15 â–¹â–¹â–¹â–¹â–¹ â–¸â–¹â–¹â–¹â–¹ â–¹â–¸â–¹â–¹â–¹ â–¹â–¹â–¸â–¹â–¹ â–¹â–¹â–¹â–¸â–¹ â–¹â–¹â–¹â–¹â–¸ â–¹â–¹â–¹â–¹â–¹ â–¹â–¹â–¹â–¹â–¹ â–¹â–¹â–¹â–¹â–¹ â–¹â–¹â–¹â–¹â–¹ â–¹â–¹â–¹â–¹â–¹ â–¹â–¹â–¹â–¹â–¹ â–¹â–¹â–¹â–¹â–¹ )
BLA_bouncing_ball=( 0.4 '(â—Â Â Â Â Â )' '(Â â—Â Â Â Â )' '(Â Â â—Â Â Â )' '(Â Â Â â—Â Â )' '(Â Â Â Â â—Â )' '(Â Â Â Â Â â—)' '(Â Â Â Â â—Â )' '(Â Â Â â—Â Â )' '(Â Â â—Â Â Â )' '(Â â—Â Â Â Â )' )
BLA_big_dot=( 0.7 âˆ™âˆ™âˆ™ â—âˆ™âˆ™ âˆ™â—âˆ™ âˆ™âˆ™â— )
BLA_modern_metro=( 0.15 â–°â–±â–±â–±â–±â–±â–± â–°â–°â–±â–±â–±â–±â–± â–°â–°â–°â–±â–±â–±â–± â–±â–°â–°â–°â–±â–±â–± â–±â–±â–°â–°â–°â–±â–± â–±â–±â–±â–°â–°â–°â–± â–±â–±â–±â–±â–°â–°â–° â–±â–±â–±â–±â–±â–°â–° â–±â–±â–±â–±â–±â–±â–° â–±â–±â–±â–±â–±â–±â–± â–±â–±â–±â–±â–±â–±â–± â–±â–±â–±â–±â–±â–±â–± â–±â–±â–±â–±â–±â–±â–± )
BLA_pong=( 0.35 'â–â ‚Â Â Â Â Â Â Â â–Œ' 'â–â ˆÂ Â Â Â Â Â Â â–Œ' 'â–Â â ‚Â Â Â Â Â Â â–Œ' 'â–Â â  Â Â Â Â Â Â â–Œ' 'â–Â Â â¡€Â Â Â Â Â â–Œ' 'â–Â Â â  Â Â Â Â Â â–Œ' 'â–Â Â Â â ‚Â Â Â Â â–Œ' 'â–Â Â Â â ˆÂ Â Â Â â–Œ' 'â–Â Â Â Â â ‚Â Â Â â–Œ' 'â–Â Â Â Â â  Â Â Â â–Œ' 'â–Â Â Â Â Â â¡€Â Â â–Œ' 'â–Â Â Â Â Â â  Â Â â–Œ' 'â–Â Â Â Â Â Â â ‚Â â–Œ' 'â–Â Â Â Â Â Â â ˆÂ â–Œ' 'â–Â Â Â Â Â Â Â â ‚â–Œ' 'â–Â Â Â Â Â Â Â â  â–Œ' 'â–Â Â Â Â Â Â Â â¡€â–Œ' 'â–Â Â Â Â Â Â â  Â â–Œ' 'â–Â Â Â Â Â Â â ‚Â â–Œ' 'â–Â Â Â Â Â â ˆÂ Â â–Œ' 'â–Â Â Â Â Â â ‚Â Â â–Œ' 'â–Â Â Â Â â  Â Â Â â–Œ' 'â–Â Â Â Â â¡€Â Â Â â–Œ' 'â–Â Â Â â  Â Â Â Â â–Œ' 'â–Â Â Â â ‚Â Â Â Â â–Œ' 'â–Â Â â ˆÂ Â Â Â Â â–Œ' 'â–Â Â â ‚Â Â Â Â Â â–Œ' 'â–Â â  Â Â Â Â Â Â â–Œ' 'â–Â â¡€Â Â Â Â Â Â â–Œ' 'â–â  Â Â Â Â Â Â Â â–Œ' )
BLA_earth=( 0.45 ðŸŒ ðŸŒŽ ðŸŒ )
BLA_clock=( 0.2 ðŸ•› ðŸ• ðŸ•‘ ðŸ•’ ðŸ•“ ðŸ•” ðŸ•• ðŸ•– ðŸ•— ðŸ•˜ ðŸ•™ ðŸ•š )
BLA_moon=( 0.8 ðŸŒ‘ ðŸŒ’ ðŸŒ“ ðŸŒ” ðŸŒ• ðŸŒ– ðŸŒ— ðŸŒ˜ )
BLA_orange_pulse=( 0.35 ðŸ”¸ ðŸ”¶ ðŸŸ  ðŸŸ  ðŸ”¶ )
BLA_blue_pulse=( 0.35 ðŸ”¹ ðŸ”· ðŸ”µ ðŸ”µ ðŸ”· )
BLA_football=( 0.25 'Â ðŸ‘§âš½ï¸Â Â Â Â Â Â Â ðŸ‘¦' 'ðŸ‘§Â Â âš½ï¸Â Â Â Â Â Â ðŸ‘¦' 'ðŸ‘§Â Â Â âš½ï¸Â Â Â Â Â ðŸ‘¦' 'ðŸ‘§Â Â Â Â âš½ï¸Â Â Â Â ðŸ‘¦' 'ðŸ‘§Â Â Â Â Â âš½ï¸Â Â Â ðŸ‘¦' 'ðŸ‘§Â Â Â Â Â Â âš½ï¸Â Â ðŸ‘¦' 'ðŸ‘§Â Â Â Â Â Â Â âš½ï¸ðŸ‘¦Â ' 'ðŸ‘§Â Â Â Â Â Â âš½ï¸Â Â ðŸ‘¦' 'ðŸ‘§Â Â Â Â Â âš½ï¸Â Â Â ðŸ‘¦' 'ðŸ‘§Â Â Â Â âš½ï¸Â Â Â Â ðŸ‘¦' 'ðŸ‘§Â Â Â âš½ï¸Â Â Â Â Â ðŸ‘¦' 'ðŸ‘§Â Â âš½ï¸Â Â Â Â Â Â ðŸ‘¦' )
BLA_blink=( 0.25 ðŸ˜ ðŸ˜ ðŸ˜ ðŸ˜ ðŸ˜ ðŸ˜ ðŸ˜ ðŸ˜ ðŸ˜ ðŸ˜‘ )
BLA_camera=( 0.1 ðŸ“· ðŸ“· ðŸ“· ðŸ“· ðŸ“· ðŸ“· ðŸ“· ðŸ“· ðŸ“· ðŸ“· ðŸ“· ðŸ“· ðŸ“· ðŸ“· ðŸ“· ðŸ“· ðŸ“· ðŸ“· ðŸ“· ðŸ“· ðŸ“¸ ðŸ“· ðŸ“¸ )
BLA_sparkling_camera=( 0.1 'ðŸ“·Â ' 'ðŸ“·Â ' 'ðŸ“·Â ' 'ðŸ“·Â ' 'ðŸ“·Â ' 'ðŸ“·Â ' 'ðŸ“·Â ' 'ðŸ“·Â ' 'ðŸ“·Â ' 'ðŸ“·Â ' 'ðŸ“·Â ' 'ðŸ“·Â ' 'ðŸ“·Â ' 'ðŸ“·Â ' 'ðŸ“·Â ' 'ðŸ“·Â ' 'ðŸ“·Â ' 'ðŸ“·Â ' 'ðŸ“·Â ' 'ðŸ“·Â ' 'ðŸ“¸âœ¨' 'ðŸ“·Â ' 'ðŸ“¸âœ¨' )
BLA_sick=( 0.9 ðŸ¤¢ ðŸ¤¢ ðŸ¤® )
BLA_monkey=( 0.4 ðŸ™‰ ðŸ™ˆ ðŸ™Š ðŸ™ˆ )
BLA_bomb=( 0.25 'ðŸ’£Â Â Â ' 'Â ðŸ’£Â Â ' 'Â Â ðŸ’£Â ' 'Â Â Â ðŸ’£' 'Â Â Â ðŸ’£' 'Â Â Â ðŸ’£' 'Â Â Â ðŸ’£' 'Â Â Â ðŸ’£' 'Â Â Â ðŸ’¥' 'Â Â Â Â ' 'Â Â Â Â ' )

declare -a BLA_active_loading_animation

BLA::play_loading_animation_loop() {
  while true ; do
    for frame in "${BLA_active_loading_animation[@]}" ; do
      printf "\r%s" "${frame}"
      sleep "${BLA_loading_animation_frame_interval}"
    done
  done
}

BLA::start_loading_animation() {
  BLA_active_loading_animation=( "${@}" )
  # Extract the delay between each frame from array BLA_active_loading_animation
  BLA_loading_animation_frame_interval="${BLA_active_loading_animation[0]}"
  unset "BLA_active_loading_animation[0]"
  tput civis # Hide the terminal cursor
  BLA::play_loading_animation_loop &
  BLA_loading_animation_pid="${!}"
}

BLA::stop_loading_animation() {
  kill "${BLA_loading_animation_pid}" &> /dev/null
  printf "\n"
  tput cnorm # Restore the terminal cursor
}


###############################################################################
################################# USAGE GUIDE #################################
###############################################################################
################## Read below for the explanations on how to ##################
################### show loading animations in your script. ###################
###############################################################################

:<<'EXAMPLES'

## Put these lines at the top of your script:
## (replace /path/to/bash_loading_animations.sh with the appropriate filepath)
# Load in the functions and animations
source /path/to/bash_loading_animations.sh
# Run BLA::stop_loading_animation if the script is interrupted
trap BLA::stop_loading_animation SIGINT

# Show a loading animation for the command "foo"
BLA::start_loading_animation "${BLA_name_of_the_animation[@]}"
foo
BLA::stop_loading_animation

# If foo prints some output in the terminal, you may want to add:
foo 1> /dev/null # hide standard output
# or
foo 2> /dev/null # hide error messages
# or
foo &> /dev/null # hide all output

EXAMPLES
